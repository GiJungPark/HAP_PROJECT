# HAP

# 프로젝트 요약

장소 추천 및 일정 저장 어플리케이션

---

# 목차

1. 기능 요구 사항
2. DB 설계
3. RESTful API 명세서
4. 서버 구조 설계
...

---

# 기능 요구 사항

1. 장소 추천 (놀거리, 먹거리)
2. 일정 및 동선 저장
3. 일정 정보 공유

---

# DB 설계

## 테이블 리스트

### 유저 테이블

1. 유저 id 식별자 PK
2. 이메일 (아이디) 대체키
3. 비밀번호 
4. 이름
5. 닉네임     
6. 전화번호  

### 일정 테이블

1. 일정 id 식별자 PK
2. 장소 id 식별자 FK
3. 시간
4. 날짜

### 장소 테이블

1. 장소 id 식별자 PK
2. 카테고리 id 식별자 FK
3. 제목 (타이틀)
4. 이미지 링크
5. 주소
6. 도로명 주소

### 카테고리 테이블

1. 카테고리 id 식별자 PK
2. 대분류: 먹거리, 놀거리
3. 소분류: 중식, 일식 등등, 이색체험, 보드게임 카페 등…

### 회원 - 일정 연결 테이블

1. 회원 - 일정 id 식별자 PK
2. 회원 id 식별자 FK
3. 일정 id 식별자 FK

### 일정 - 장소 연결 테이블

1. 일정 - 장소 id 식별자 PK
2. 일정 id 식별자 FK
3. 장소 id 식별자 FK

---

## ERD

![HAP_ERD.png](README_IMAGE/HAP_ERD.png)

---

# RESTful API 설계

## API 참고사항

POST 방식의 API 호출의 응답은 다음과 같다.

- 헤더: 상태코드를 포함한다.

- 바디: 메세지를 JSON 형식으로 응답한다.

GET 방식의 API 호출의 응답은 다음과 같다.

- 헤더: 상태코드를 포함한다.

- 바디: API에 알맞는 데이터를 JSON 형식으로 응답한다.

회원 API, 인증 API 를 제외한 일정 API, 검색 API 는 토큰을 꼭 기입해야한다.

단, 회원 API 로그아웃의 경우 토큰을 헤더에 기입해야한다.

---

# 회원 API
## 회원가입
### POST /api/v1/user

- 회원 가입을 진행한다.
- 이메일(아이디) 인증 절차와 전화번호, 닉네임은 중복 확인 절차를 거친 후 호출 해야한다.
- Body에 이메일, 비밀번호, 이름, 닉네임, 전화번호를 JSON 형식으로 기입해야 한다.
    ```json
  {
  "email": "{이메일}",
  "password": "{비밀번호}",
  "name": "{이름}",
  "nickname": "{닉네임}",
  "phone": "{전화번호}"
  } 
    ```
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "SUCCESS"
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "{409}",
      "message": "{에러메세지}"
    }
    ```
  이메일, 전화번호, 닉네임 중 하나 이상 중복되는 경우 다음과 같은 메세지 출력
  - 이메일 : 해당 이메일은 이미 사용중입니다.
  - 전화번호 : 해당 전화번호는 이미 사용중입니다.
  - 닉네임 : 해당 닉네임은 이미 사용중입니다.

---

## 중복확인
### GET /api/v1/user/duplicate/email?email={email}

- 이메일의 중복을 확인한다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "사용가능한 이메일입니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "409",
      "message": "해당 이메일은 이미 사용중입니다."
    }
    ```

<br>

### GET /api/v1/user/duplicate/nickname?nickname={nickname}

- 닉네임의 중복을 확인한다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "사용가능한 닉네임입니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "409",
      "message": "해당 닉네임은 이미 사용중입니다."
    }
    ```

<br>

### GET /api/v1/user/duplicate/phone?phone={phone}

- 전화번호의 중복을 확인한다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "사용가능한 전화번호입니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "409",
      "message": "해당 전화번호는 이미 사용중입니다."
    }
    ```

---
## 이메일 찾기 / 비밀번호 변경
### GET /api/v1/user/email?name={name}&phone={phone}

- 회원의 가입한 이메일을 확인한다.

- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "email": "{email}"
    }
    ```
  
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "404",
      "message": "{message}"
    }
    ```
  이름, 전화번호로 가입된 정보가 존재하지 않는 경우 다음과 같은 메세지 출력
  - 이름 : "해당 이름으로 가입된 정보가 존재하지 않습니다."
  - 전화번호 : "해당 전화번호로 가입된 정보가 존재하지 않습니다."

<br>

### POST /api/v1/user/password

- 회원의 비밀번호를 변경한다.
- 이메일(아이디) 인증 절차를 거친 후 호출 해야한다.
- Body에 이메일, 새로운 비밀번호를 JSON 형식으로 기입해야 한다.
    ```json
    {
      "email": "{이메일}",
      "password": "{새로운 비밀번호}"
    } 
    ```

- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "비밀번호가 변경되었습니다."
    }
    ```
  
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "404",
      "message": "해당 이메일로 가입된 정보가 존재하지 않습니다."
    }
    ```
  
---

## 로그인 / 로그아웃
### POST /api/v1/user/login

- 로그인을 진행한다.
- Body에 이메일, 비밀번호를 JSON 형식으로 기입해야 한다.
    ```json
    {
      "email": "{이메일}",
      "password": "{비밀번호}"
    } 
    ```

- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "token": "{생성된 토큰}"
    }
    ```

- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "{ErrorCode}",
      "message": "{message}"
    }
    ```
  가입된 이메일 정보가 존재하지 않거나, 비밀번호가 일치하지 않는 경우 다음과 같은 코드, 메세지 출력
  - status: 404, message: "해당 이메일로 가입된 정보가 존재하지 않습니다."
  - status: 401, message: "비밀번호를 잘못 입력하였습니다."

<br>

### POST /api/v1/user/logout

- 로그아웃을 진행한다.
- 헤더에 토큰을 삽입하여 보내야 한다.

- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "SUCCESS"
    }
    ```
  
- 호출 실패의 경우는 클라이언트에서 잘못된 토큰을 보내는 경우이기 때문에 별도로 존재하지 않는다.
- 만일 잘못된 토큰이 입력된 경우 별도의 메세지 없이 403 에러가 호출된다.

---

### PATCH /api/v1/user/{회원 아이디}

- /api/v1/user/password/{회원 아이디} 비밀번호 변경
해당 API는 본인 인증 절차를 거친 후에 호출해야 한다.

- /api/v1/user/user_phone/{회원 아이디} 전화번호 변경
해당 API는 닉네임 중복 확인 절차를 걸친 후 호출해야 한다.

- /api/v1/user/user_nickname/{회원 아이디} 닉네임 변경
해당 API는 닉네임 중복 확인 절차를 걸친 후 호출해야 한다.

- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
(전화번호, 닉네임 중 하나 이상 중복되는 경우)

DELET /api/v1/user/{회원 아이디}

- 회원 정보를 삭제한다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
(회원 아이디가 조회되지 않는 경우)

---

# 인증 API
## 회원가입 이메일 인증
### GET /api/v1/user/singUp/emailVerifications?email={이메일}

- 해당 이메일로 인증 번호를 전송한다.
- 인증 코드의 유효기간은 10분이다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다. 그리고 해당 메일로 인증 번호가 전송된다. 
    ```json
    {
      "status": "OK",
      "message": "인증번호가 전송되었습니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "409",
      "message": "해당 이메일은 이미 사용중입니다."
    }
    ```

<br>

### POST /api/v1/user/singUp/emailVerifications

- 인증 번호를 인증한다.
- Body에 아이디, 인증 번호를 JSON 형식으로 기입해야 한다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "인증에 성공했습니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "401",
      "message": "인증 코드를 잘못 입력하였습니다."
    }
    ```
  만일 인증 유효 시간이 지난 경우 별도의 메세지 없이 403 에러가 호출된다.

<br>

## 비밀번호 변경 이메일 인증
### GET /api/v1/user/changePassword/emailVerifications?email={이메일}

- 해당 이메일로 인증 번호를 전송한다.
- 인증 코드의 유효기간은 10분이다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다. 그리고 해당 메일로 인증 번호가 전송된다.
    ```json
    {
      "status": "OK",
      "message": "인증번호가 전송되었습니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "404",
      "message": "해당 이메일로 가입된 정보가 존재하지 않습니다."
    }
    ```

<br>

### POST /api/v1/user/changePassword/emailVerifications

- 인증 번호를 인증한다.
- Body에 아이디, 인증 번호를 JSON 형식으로 기입해야 한다.
- 호출 성공 시: 성공 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "OK",
      "message": "인증에 성공했습니다."
    }
    ```
- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "401",
      "message": "인증 코드를 잘못 입력하였습니다."
    }
    ```
  만일 인증 유효 시간이 지난 경우 별도의 메세지 없이 403 에러가 호출된다.


---

# 검색 API
### GET /api/v1/search?query={검색내용}

- 네이버 API를 통해 {검색내용}을 검색한다.
- 호출 성공 시: 타이틀(가게 이름), 이미지 링크, 주소, 도로명 주소, 카테고리를 리스트로 JSON 형식으로 응답한다.
- 호출되는 리스트는 최소 1개에서 최대 5개까지 검색 결과에 따라서 출력된다.
    ```json
    {
      "items": [
        {
          "title": "{가게명}",
          "address": "{주소}",
          "readAddress": "{도로주소}",
          "imageLink": "{이미지링크}"
        },
        ...
      ]
    }
    ```

- 호출 실패 시: 에러 메세지를 JSON 형식으로 응답한다.
    ```json
    {
      "status": "404",
      "message": "검색 정보가 없습니다."
    }
    ```
    해당 키워드의 검색 결과가 없는 경우 해당 결과가 발생하며, 지역 및 카테고리 설정하는 방향으로 개선할 예정

---

### 일정 API

POST /api/v1/schedule 일정 등록

- 

GET /api/v1/schedule/{회원아이디}&{날짜} 회원의 일정 조회

- 

PUT /api/v1/schedule/{회원아이디} 회원의 일정 전체 수정

- 

DELET /api/v1/schedule/{회원아이디} 회원의 일정 정보 삭제

- 

---

# 서버 구조 설계

...